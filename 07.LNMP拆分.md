# LNMP

#### 一、扩展数据库

单台服务器运行LNMP架构会导致网站访问缓慢，因为数据库比较消耗内存，内存被消耗完时容易导致系统出现oom，从而终止数据库进程，所以需要将web站点和数据库进行独立部署

```diff
+ OOM：`Out Of Memory`，内存溢出，随机杀死一个进程，优先杀死占用内存高的进程
```

**数据库拆分解决的问题**

- 缓解web网站压力
- 增强数据库读写性能
- 提高用户访问速度

**环境规划**

| 主机名 |   环境    |  外网地址   |   内网地址    |
| :----: | :-------: | :---------: | :-----------: |
|  web   | nginx+php | 10.250.1.41 | 192.168.42.41 |
|   db   |   mysql   |             | 192.168.42.42 |

**操作步骤**

1. 备份web节点上mysql的数据

```shell
# mysqldump -uroot -p'000000' wordpress > wordpress.sql
```

2. 将备份数据拷贝到db节点

```shell
# scp wordpress.sql root@192.168.42.42:/opt/
```

3. 拆包，还原备份数据

```shell
[root@mysql opt]# mysql < wordpress.sql
```





#### 二、扩展多web节点



#### 三、扩展后端静态存储

将静态资源放在后端共享存储上，节省多web节点的磁盘空间，保持多节点的数据一致性

